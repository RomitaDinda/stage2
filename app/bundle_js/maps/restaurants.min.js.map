{"version":3,"sources":["restaurants.min.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","obj","dbPromise","_idb","__esModule","default","_defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","DBHelper","instance","Constructor","TypeError","_classCallCheck","this","protoProps","staticProps","value","open","upgradeDb","createObjectStore","keyPath","openDatabase","then","db","transaction","objectStore","getAll","callback","getCachedMessages","data","fetch","DATABASE_URL","credentials","res","console","log","json","store","forEach","restaurant","put","openCursor","cursor","advance","deleteRest","delete","continue","catch","err","id","fetchRestaurants","error","restaurants","find","cuisine","results","filter","cuisine_type","neighborhood","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","concat","photograph","google","maps","Marker","position","latlng","title","name","url","urlForRestaurant","animation","Animation","DROP","get","prototype","idb","2","navigator","serviceWorker","register","scope","registration","3","_dbhelper","window","initMap","fetchRestaurantFromURL","Map","document","getElementById","zoom","center","scrollwheel","fillBreadcrumb","mapMarkerForRestaurant","getParameterByName","fetchRestaurantById","fillRestaurantHTML","arguments","undefined","innerHTML","address","image","className","src","imageUrlForRestaurant","alt","operating_hours","fillRestaurantHoursHTML","fillReviewsHTML","operatingHours","hours","row","createElement","day","appendChild","time","reviews","container","setAttribute","noReviews","ul","review","createReviewHTML","li","tabIndex","date","rating","comments","breadcrumb","location","href","replace","RegExp","exec","decodeURIComponent","./dbhelper","4","staticCacheId","imgCache","allCaches","urlsToCache","self","addEventListener","event","waitUntil","caches","cache","addAll","skipWaiting","request","requestUrl","URL","port","pathname","startsWith","respondWith","match","response","networkResponse","clone","fetchResponse","includes","keys","cacheNames","Promise","all","cacheName","5","promisifyRequest","resolve","reject","onsuccess","result","onerror","promisifyRequestCall","method","args","apply","proxyProperties","ProxyClass","targetProp","properties","prop","set","val","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Cursor","Index","index","_index","_cursor","_request","ObjectStore","_store","Transaction","idbTransaction","_tx","complete","oncomplete","onabort","UpgradeDB","oldVersion","_db","DB","IDBIndex","IDBCursor","methodName","createIndex","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","arr","Array","slice","nativeObject","query","count","items","iterateCursor","push","exp","version","upgradeCallback","indexedDB","onupgradeneeded"],"mappings":"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","file":"../restaurants.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nvar _idb = _interopRequireDefault(require(\"idb\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\r\n * Common database helper functions.\r\n */\nvar dbPromise;\n\nvar DBHelper =\n/*#__PURE__*/\nfunction () {\n  function DBHelper() {\n    _classCallCheck(this, DBHelper);\n  }\n\n  _createClass(DBHelper, null, [{\n    key: \"openDatabase\",\n\n    /**\r\n     * Open a IDB Database\r\n     */\n    value: function openDatabase() {\n      return _idb.default.open('rbc-restaurants', 1, function (upgradeDb) {\n        upgradeDb.createObjectStore('restaurants', {\n          keyPath: 'id'\n        });\n      });\n    }\n    /**\r\n     * Database URL.\r\n     * Change this to restaurants.json file location on your server.\r\n     */\n\n  }, {\n    key: \"getCachedMessages\",\n\n    /**\r\n     * Show cached restaurants stored in IDB\r\n     */\n    value: function getCachedMessages() {\n      dbPromise = DBHelper.openDatabase();\n      return dbPromise.then(function (db) {\n        //if we showing posts or very first time of the page loading.\n        //we don't need to go to idb\n        if (!db) return;\n        var tx = db.transaction('restaurants');\n        var store = tx.objectStore('restaurants');\n        return store.getAll();\n      });\n    }\n    /**\r\n     * Fetch all restaurants.\r\n     */\n\n  }, {\n    key: \"fetchRestaurants\",\n    value: function fetchRestaurants(callback) {\n      DBHelper.getCachedMessages().then(function (data) {\n        // if we have data to show then we pass it immediately.\n        if (data.length > 0) {\n          return callback(null, data);\n        } // After passing the cached messages.\n        // We need to update the cache with fetching restaurants from network.\n\n\n        fetch(DBHelper.DATABASE_URL, {\n          credentials: 'same-origin'\n        }).then(function (res) {\n          console.log('res fetched is: ', res);\n          return res.json();\n        }).then(function (data) {\n          dbPromise.then(function (db) {\n            if (!db) return db;\n            console.log('data fetched is: ', data);\n            var tx = db.transaction('restaurants', 'readwrite');\n            var store = tx.objectStore('restaurants');\n            data.forEach(function (restaurant) {\n              return store.put(restaurant);\n            }); // limit the data for 30\n\n            store.openCursor(null, 'prev').then(function (cursor) {\n              return cursor.advance(30);\n            }).then(function deleteRest(cursor) {\n              if (!cursor) return;\n              cursor.delete();\n              return cursor.continue().then(deleteRest);\n            });\n          });\n          return callback(null, data);\n        }).catch(function (err) {\n          return callback(err, null);\n        });\n      });\n    }\n    /**\r\n     * Fetch a restaurant by its ID.\r\n     */\n\n  }, {\n    key: \"fetchRestaurantById\",\n    value: function fetchRestaurantById(id, callback) {\n      // fetch all restaurants with proper error handling.\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          var restaurant = restaurants.find(function (r) {\n            return r.id == id;\n          });\n\n          if (restaurant) {\n            // Got the restaurant\n            callback(null, restaurant);\n          } else {\n            // Restaurant does not exist in the database\n            callback('Restaurant does not exist', null);\n          }\n        }\n      });\n    }\n    /**\r\n     * Fetch restaurants by a cuisine type with proper error handling.\r\n     */\n\n  }, {\n    key: \"fetchRestaurantByCuisine\",\n    value: function fetchRestaurantByCuisine(cuisine, callback) {\n      // Fetch all restaurants  with proper error handling\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Filter restaurants to have only given cuisine type\n          var results = restaurants.filter(function (r) {\n            return r.cuisine_type == cuisine;\n          });\n          callback(null, results);\n        }\n      });\n    }\n    /**\r\n     * Fetch restaurants by a neighborhood with proper error handling.\r\n     */\n\n  }, {\n    key: \"fetchRestaurantByNeighborhood\",\n    value: function fetchRestaurantByNeighborhood(neighborhood, callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Filter restaurants to have only given neighborhood\n          var results = restaurants.filter(function (r) {\n            return r.neighborhood == neighborhood;\n          });\n          callback(null, results);\n        }\n      });\n    }\n    /**\r\n     * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n     */\n\n  }, {\n    key: \"fetchRestaurantByCuisineAndNeighborhood\",\n    value: function fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          var results = restaurants;\n\n          if (cuisine != 'all') {\n            // filter by cuisine\n            results = results.filter(function (r) {\n              return r.cuisine_type == cuisine;\n            });\n          }\n\n          if (neighborhood != 'all') {\n            // filter by neighborhood\n            results = results.filter(function (r) {\n              return r.neighborhood == neighborhood;\n            });\n          }\n\n          callback(null, results);\n        }\n      });\n    }\n    /**\r\n     * Fetch all neighborhoods with proper error handling.\r\n     */\n\n  }, {\n    key: \"fetchNeighborhoods\",\n    value: function fetchNeighborhoods(callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Get all neighborhoods from all restaurants\n          var neighborhoods = restaurants.map(function (v, i) {\n            return restaurants[i].neighborhood;\n          }); // Remove duplicates from neighborhoods\n\n          var uniqueNeighborhoods = neighborhoods.filter(function (v, i) {\n            return neighborhoods.indexOf(v) == i;\n          });\n          callback(null, uniqueNeighborhoods);\n        }\n      });\n    }\n    /**\r\n     * Fetch all cuisines with proper error handling.\r\n     */\n\n  }, {\n    key: \"fetchCuisines\",\n    value: function fetchCuisines(callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Get all cuisines from all restaurants\n          var cuisines = restaurants.map(function (v, i) {\n            return restaurants[i].cuisine_type;\n          }); // Remove duplicates from cuisines\n\n          var uniqueCuisines = cuisines.filter(function (v, i) {\n            return cuisines.indexOf(v) == i;\n          });\n          callback(null, uniqueCuisines);\n        }\n      });\n    }\n    /**\r\n     * Restaurant page URL.\r\n     */\n\n  }, {\n    key: \"urlForRestaurant\",\n    value: function urlForRestaurant(restaurant) {\n      return \"./restaurant.html?id=\".concat(restaurant.id);\n    }\n    /**\r\n     * Restaurant image URL.\r\n     */\n\n  }, {\n    key: \"imageUrlForRestaurant\",\n    value: function imageUrlForRestaurant(restaurant) {\n      return \"/img/\".concat(restaurant.photograph, \".jpg\");\n    }\n    /**\r\n     * Map marker for a restaurant.\r\n     */\n\n  }, {\n    key: \"mapMarkerForRestaurant\",\n    value: function mapMarkerForRestaurant(restaurant, map) {\n      var marker = new google.maps.Marker({\n        position: restaurant.latlng,\n        title: restaurant.name,\n        url: DBHelper.urlForRestaurant(restaurant),\n        map: map,\n        animation: google.maps.Animation.DROP\n      });\n      return marker;\n    }\n  }, {\n    key: \"DATABASE_URL\",\n    get: function get() {\n      var port = 1337; // Change this to your server port\n\n      return \"http://localhost:\".concat(port, \"/restaurants\");\n    }\n  }]);\n\n  return DBHelper;\n}();\n\nmodule.exports = DBHelper;\n\n},{\"idb\":5}],2:[function(require,module,exports){\n\"use strict\";\n\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker.register('/sw.js', {\n    scope: '/'\n  }).then(function (registration) {\n    console.log('Service worker registered :D ' + registration.scope);\n  }).catch(function (error) {\n    console.log('Registration failed: ' + error);\n  });\n}\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nvar _dbhelper = _interopRequireDefault(require(\"./dbhelper\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar restaurant;\nvar map;\n/**\n * Initialize Google map, called from HTML.\n */\n\nwindow.initMap = function () {\n  fetchRestaurantFromURL(function (error, data) {\n    if (error) {\n      // Got an error!\n      console.error(error);\n    } else {\n      map = new google.maps.Map(document.getElementById('map'), {\n        zoom: 16,\n        center: data.latlng,\n        scrollwheel: false\n      });\n      fillBreadcrumb();\n\n      _dbhelper.default.mapMarkerForRestaurant(restaurant, map);\n    }\n  });\n};\n/**\n * Get current restaurant from page URL.\n */\n\n\nvar fetchRestaurantFromURL = function fetchRestaurantFromURL(callback) {\n  if (restaurant) {\n    // restaurant already fetched!\n    callback(null, restaurant);\n    return;\n  }\n\n  var id = getParameterByName('id');\n\n  if (!id) {\n    // no id found in URL\n    error = 'No restaurant id in URL';\n    callback(error, null);\n  } else {\n    _dbhelper.default.fetchRestaurantById(id, function (error, data) {\n      restaurant = data;\n\n      if (!data) {\n        console.error(error);\n        return;\n      }\n\n      fillRestaurantHTML();\n      callback(null, data);\n    });\n  }\n};\n/**\n * Create restaurant HTML and add it to the webpage\n */\n\n\nvar fillRestaurantHTML = function fillRestaurantHTML() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : restaurant;\n  var name = document.getElementById('restaurant-name');\n  name.innerHTML = data.name;\n  var address = document.getElementById('restaurant-address');\n  address.innerHTML = data.address;\n  var image = document.getElementById('restaurant-img');\n  image.className = 'restaurant-img';\n  image.src = _dbhelper.default.imageUrlForRestaurant(restaurant);\n  image.alt = data.name + \" restaurant's photo.\";\n  var cuisine = document.getElementById('restaurant-cuisine');\n  cuisine.innerHTML = data.cuisine_type; // fill operating hours\n\n  if (restaurant.operating_hours) {\n    fillRestaurantHoursHTML();\n  } // fill reviews\n\n\n  fillReviewsHTML();\n};\n/**\n * Create restaurant operating hours HTML table and add it to the webpage.\n */\n\n\nvar fillRestaurantHoursHTML = function fillRestaurantHoursHTML() {\n  var operatingHours = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : restaurant.operating_hours;\n  var hours = document.getElementById('restaurant-hours');\n\n  for (var key in operatingHours) {\n    var row = document.createElement('tr');\n    var day = document.createElement('td');\n    day.innerHTML = key;\n    row.appendChild(day);\n    var time = document.createElement('td');\n    time.innerHTML = operatingHours[key];\n    row.appendChild(time);\n    hours.appendChild(row);\n  }\n};\n/**\n * Create all reviews HTML and add them to the webpage.\n */\n\n\nvar fillReviewsHTML = function fillReviewsHTML() {\n  var reviews = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : restaurant.reviews;\n  var container = document.getElementById('reviews-container');\n  var title = document.createElement('h2');\n  title.innerHTML = 'Reviews';\n  title.setAttribute('tabindex', '0');\n  container.appendChild(title);\n\n  if (!reviews) {\n    var noReviews = document.createElement('p');\n    noReviews.innerHTML = 'No reviews yet!';\n    container.appendChild(noReviews);\n    return;\n  }\n\n  var ul = document.getElementById('reviews-list');\n  reviews.forEach(function (review) {\n    ul.appendChild(createReviewHTML(review));\n  });\n  container.appendChild(ul);\n};\n/**\n * Create review HTML and add it to the webpage.\n */\n\n\nvar createReviewHTML = function createReviewHTML(review) {\n  var li = document.createElement('li');\n  li.tabIndex = 0;\n  var name = document.createElement('p');\n  name.innerHTML = review.name;\n  li.appendChild(name);\n  var date = document.createElement('p');\n  date.innerHTML = review.date;\n  li.appendChild(date);\n  var rating = document.createElement('p');\n  rating.innerHTML = \"Rating: \".concat(review.rating);\n  li.appendChild(rating);\n  var comments = document.createElement('p');\n  comments.innerHTML = review.comments;\n  li.appendChild(comments);\n  return li;\n};\n/**\n * Add restaurant name to the breadcrumb navigation menu\n */\n\n\nvar fillBreadcrumb = function fillBreadcrumb() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : restaurant;\n  var breadcrumb = document.getElementById('breadcrumb');\n  var li = document.createElement('li');\n  li.innerHTML = data.name;\n  li.setAttribute('aria-current', 'page');\n  breadcrumb.appendChild(li);\n};\n/**\n * Get a parameter by name from page URL.\n */\n\n\nvar getParameterByName = function getParameterByName(name, url) {\n  if (!url) url = window.location.href;\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\n  var regex = new RegExp(\"[?&]\".concat(name, \"(=([^&#]*)|&|#|$)\")),\n      results = regex.exec(url);\n  if (!results) return null;\n  if (!results[2]) return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n};\n\n},{\"./dbhelper\":1}],4:[function(require,module,exports){\n\"use strict\";\n\n//import DBHelper from './js/dbhelper';\nvar staticCacheId = \"restaurants-static-v2\";\nvar imgCache = \"restaurants-imgs\";\nvar allCaches = [staticCacheId, imgCache];\nvar urlsToCache = [\"./\", \"js/register.js\", \"index.html\", \"restaurant.html\", \"css/styles.css\", \"js/dbhelper.js\", \"js/main.js\", \"js/restaurant_info.js\", \"img/1.jpg\", \"img/2.jpg\", \"img/3.jpg\", \"img/4.jpg\", \"img/5.jpg\", \"img/6.jpg\", \"img/7.jpg\", \"img/8.jpg\", \"img/9.jpg\", \"img/10.jpg\", \"img/nocon.png\", \"icons/icon-72x72.png\", 'bundle_js/index.min.js', 'bundle_js/maps/index.min.js.map', 'bundle_js/maps/restaurants.min.js.map', 'bundle_js/restaurants.min.js'];\nself.addEventListener(\"install\", function (event) {\n  event.waitUntil(caches.open(staticCacheId).then(function (cache) {\n    console.log('Opened cache');\n    return cache.addAll(urlsToCache);\n  }).then(self.skipWaiting()));\n});\nself.addEventListener('fetch', function (event) {\n  var requestUrl = new URL(event.request.url);\n  console.log('the url port is:' + requestUrl.port);\n\n  if (requestUrl.pathname.startsWith('/restaurants/')) {\n    console.log('entro al api de restaurants');\n    return;\n  }\n\n  if (requestUrl.pathname.startsWith('/img/')) {\n    // console.log('sw entro al img');\n    event.respondWith(loadPhoto(event.request));\n    return;\n  }\n\n  event.respondWith(caches.open(staticCacheId).then(function (cache) {\n    return cache.match(event.request).then(function (response) {\n      return response || fetch(event.request).then(function (response) {\n        // filter out browser-sync resources\n        if (!fetchResponse.url.includes('browser-sync')) {\n          console.log('response no browsersync');\n          cache.put(event.request, response.clone());\n        }\n\n        return response;\n      });\n    }).catch(function () {\n      return caches.match(\"/img/nocon.png\");\n    });\n  }));\n});\nself.addEventListener('activate', function (event) {\n  event.waitUntil( // Get all the cache keys \n  caches.keys().then(function (cacheNames) {\n    return Promise.all(cacheNames.filter(function (cacheName) {\n      return cacheName.startsWith('restaurants-') && !allCaches.includes(cacheName);\n    }).map(function (cacheName) {\n      return caches.delete(cacheName);\n    }));\n  }));\n});\n\nfunction loadPhoto(request) {\n  return caches.open(imgCache).then(function (cache) {\n    return cache.match(request).then(function (response) {\n      if (response) return response;\n      return fetch(request).then(function (networkResponse) {\n        cache.put(request, networkResponse.clone());\n        return networkResponse;\n      });\n    });\n  });\n}\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n},{}]},{},[3,1,2,4]);\n"]}